# Blender用衣服フィッティングツール

[![en](https://img.shields.io/badge/lang-English-blue.svg)](README.md)
[![cn](https://img.shields.io/badge/语言-中文-red.svg)](README.zh-CN.md)
[![jp](https://img.shields.io/badge/言語-日本語-white.svg)](README.ja.md)

これは3Dキャラクターモデルへの衣服の適合プロセスを加速するためのシンプルなBlenderアドオンです。このツールは、すでにキャラクターの形状に近い衣服をさらにフィットさせながら、全体的な形状やしわの細部を保持します。衣服のフィッティングに悩んでおり、専用ツールを使用したことがない場合は、試してみる価値があるかもしれません。

## 機能

このツールは様々な投影方法を使用して、衣服メッシュの頂点をキャラクターモデルの表面から理想的な距離に調整します：

- 複数の投影タイプ：中心点からの投影、頂点法線、最近点、および混合方法
- 調整可能な影響範囲とフォールオフ関数
- 交差する頂点の自動検出と修正
- インタラクティブな頂点選択
- 特定領域の微調整サポート

## インストール

1. `clothing_fit_tool.py`ファイルをダウンロード
2. Blenderで`編集 > 設定 > アドオン > インストール...`に移動
3. ダウンロードしたpyファイルを選択
4. アドオンを有効化

## 使用ガイド

### 基本的なワークフロー

1. 3Dビューのサイドバーで「Clothing Fit Tool」パネルを見つける
2. 衣服オブジェクトとキャラクターの体オブジェクトを選択
3. パラメータ（ソフト範囲、フォールオフタイプ、理想距離など）を調整
4. 編集モードに入り、フィットさせる頂点を選択（N²の複雑さのため、すべての頂点ではなく参照点を選択—例：衣服の端—近くの点はソフト範囲に基づいて追従）
5. 「Apply Clothing Fit」をクリックして適用

### パラメータ説明

- **Clothing Object**: フィットさせる衣服メッシュ
- **Body Object**: キャラクターの体メッシュ
- **Soft Range**: 選択した頂点が周囲の形状にどれだけ影響するかを決定する影響半径
- **Falloff Type**: 影響の減衰タイプ（線形、二次、指数関数など - 最も滑らかな結果にはcosineが推奨）
- **Ideal Distance**: 衣服と体の間の目標距離
- **Projection Type**: 投影を計算する方法
  - **From Center**: 中心点から投影（崩壊を引き起こす可能性あり）
  - **Vertex Normal**: 頂点法線に沿って投影（不良な法線を自動的にフィルタリング）
  - **Nearest Point**: 体メッシュ上の最近点を見つける
  - **Mixed Method**: 複数の投影方法を組み合わせる（崩壊を引き起こす可能性あり）
- **Ray Offset**: 法線方向に沿ってレイ開始位置をオフセットする距離

### ヒントとコツ

1. **段階的なフィッティング**: 
   - 全体調整には大きめのSoft Rangeから始める
   - 徐々にSoft Rangeを減らして微調整する

2. **投影方法の選択**:
   - ほとんどの場合は「Mixed Method」が最適
   - 脇の下や股間などの複雑な領域には「Vertex Normal」を使用

3. **交差の処理**:
   - 交差は一般的 - 「Fix Intersecting」を使用して解決
   - 手動修正の場合、「Select Intersecting」を使用して編集モードで問題のある頂点を特定

4. **選択的調整**:
   - 最高のパフォーマンスと制御のために、多くの頂点ではなく少数の重要な参照点を選択
   - 頂点選択が密集していると複数回考慮される - 参照頂点が均等に分布するようにする

## 制限事項

- 現在の実装は基本的なもので、主にメッシュの交差とフィッティングワークフローの高速化に役立つ
- 重み伝播メカニズムは遅く、一度に数千の頂点には適していない
- 特殊なケースでは手動調整が必要な場合もある

## 潜在的な改善点

- ラプラシアン補間による変形の改善
- より良いパフォーマンスのための重み計算の最適化
- より高度な交差検出と修正アルゴリズムの開発

## 追加情報

- このツール（このREADMEを含む）は、AIの支援を受けて作成されました
- これは衣服フィッティングを加速するための一時的なソリューションです。才能ある個人によって開発されているUnity用の自動衣服フィッティングツールの完成を楽しみにしています。
